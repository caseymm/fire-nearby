(this["webpackJsonpfire-nearby"]=this["webpackJsonpfire-nearby"]||[]).push([[0],{12:function(e,t,a){},63:function(e,t,a){"use strict";a.r(t);var o=a(0),n=a.n(o),s=a(17),i=a.n(s),r=(a(23),a(12),a(13),a(6)),c=a(2),l=a(4),d=a.n(l),h=a(5),p=a(1);d.a.accessToken="pk.eyJ1IjoiY2FzZXltbWlsZXIiLCJhIjoiY2lpeHY1bnJ1MDAyOHVkbHpucnB1dGRmbyJ9.TzUoCLwyeDoLjh3tkDSD4w";class u extends o.Component{constructor(e){super(e),this.state={lng:-98.78320225360663,lat:40.45646421496375,zoom:3.5},this.mapContainer=n.a.createRef()}componentDidMount(){const{lng:e,lat:t,zoom:a}=this.state,o=new d.a.Map({container:this.mapContainer.current,style:"mapbox://styles/caseymmiler/cl11818ga000216ng2az1efhm",center:[e,t],zoom:a}),n=new d.a.ScaleControl({maxWidth:150,unit:"imperial"});o.addControl(n),n.setUnit("imperial"),async function(){const e=await fetch("https://firenearby.s3.amazonaws.com/latest.json");return await e.json()}().then((e=>{console.log("ran load"),o.addSource("data-json",{type:"geojson",data:e}),o.addLayer({id:"points",type:"symbol",source:"data-json",layout:{"icon-image":"orange-x-box2","text-field":["get","IncidentName"],"text-font":["Ubuntu Mono Bold","Arial Unicode MS Bold"],"text-size":16,"text-offset":[0,1.25],"text-anchor":"top","icon-allow-overlap":!0,"text-allow-overlap":!1}});const t=h.bbox(e);o.fitBounds(t,{padding:100,duration:0})}))}render(){return Object(p.jsxs)("div",{children:[Object(p.jsx)("div",{ref:this.mapContainer,className:"map-container"}),Object(p.jsx)("div",{className:"title",children:Object(p.jsx)("h1",{children:"Wildfires in the last 24 hours"})}),Object(p.jsxs)("div",{className:"title-about",children:[Object(p.jsx)(r.b,{to:"/sign-up",children:Object(p.jsx)("span",{children:"Sign up"})}),Object(p.jsx)(r.b,{to:"/about",children:Object(p.jsx)("span",{children:"About"})})]})]})}}var m=e=>Object(p.jsx)(u,{});d.a.accessToken="pk.eyJ1IjoiY2FzZXltbWlsZXIiLCJhIjoiY2lpeHY1bnJ1MDAyOHVkbHpucnB1dGRmbyJ9.TzUoCLwyeDoLjh3tkDSD4w";class j extends o.Component{constructor(e){super(e),this.state={lng:-98.78320225360663,lat:40.45646421496375,zoom:3.5},this.mapContainer=n.a.createRef()}componentDidMount(){const{lng:e,lat:t,zoom:a}=this.state,o=new d.a.Map({container:this.mapContainer.current,style:"mapbox://styles/caseymmiler/cl11818ga000216ng2az1efhm",center:[e,t],zoom:a}),n=new d.a.ScaleControl({maxWidth:150,unit:"imperial"});o.addControl(n);const s=window.location.hash.replace("#/screenshot?","").split("&").map((e=>e.split("="))).reduce(((e,[t,a])=>({...e,[t]:a})),{}),i=e=>{let t=e.split(",");return console.log(t),[parseFloat(t[0]),parseFloat(t[1])]};console.log(s);const r={type:"FeatureCollection",features:[{type:"Feature",properties:{category:"userLoc"},geometry:{type:"Point",coordinates:i(s.userLoc)}}]},c={type:"FeatureCollection",features:[{type:"Feature",properties:{category:"fireLoc"},geometry:{type:"Point",coordinates:i(s.fireLoc)}}]};o.on("load",(function(){console.log("ran load"),o.addSource("data-json",{type:"geojson",data:r}),o.addLayer({id:"data-json-layer",type:"circle",source:"data-json",layout:{},paint:{"circle-radius":7,"circle-color":"#5444e3","circle-stroke-color":"#ffffff","circle-stroke-width":2}}),o.addLayer({id:"data-json-layer-text",type:"symbol",source:"data-json",layout:{"text-field":decodeURI(s.userLocName),"text-font":["Ubuntu Mono Bold","Arial Unicode MS Bold"],"text-size":18,"text-offset":[0,1],"text-anchor":"top"}}),o.addSource("data-json-fire",{type:"geojson",data:c}),o.addLayer({id:"points",type:"symbol",source:"data-json-fire",layout:{"icon-image":"orange-x-box2","text-field":decodeURI(s.fireLocName),"text-font":["Ubuntu Mono Bold","Arial Unicode MS Bold"],"text-size":18,"text-offset":[0,1.25],"text-anchor":"top"}});const e={type:"FeatureCollection",features:[r.features[0],c.features[0]]},t=h.bbox(e);o.fitBounds(t,{padding:120,duration:0}),setTimeout((function(){console.log("posting div"),(()=>{console.log("loaded");const e=document.createElement("div");e.id="hidden",document.getElementsByClassName("map-container")[0].appendChild(e)})()}),5e3)}))}render(){return Object(p.jsx)("div",{children:Object(p.jsx)("div",{ref:this.mapContainer,className:"map-container"})})}}var b=e=>Object(p.jsx)(j,{}),x=a(18),y=a.n(x);a(62);let f={location:"",radius:"20",coordinates:"",rangeDrawn:!1,dotDrawn:!1};class g extends n.a.Component{constructor(e){super(e),this.state={username:"",location:"",phoneNumber:"",radius:"20",coordinates:""},this.mapContainerLocation=n.a.createRef(),this.handleChange=this.handleChange.bind(this),this.handleSubmit=this.handleSubmit.bind(this)}handleChange(e){this.setState({[e.target.name]:e.target.value})}handleSubmit(e){this.state.phoneNumber=this.state.phoneNumber.replace(/[^+\d]+/g,""),this.state.location=f.location,this.state.coordinates=f.coordinates,this.state.radius=f.radius,fetch("https://rlepoghcjh.execute-api.us-west-2.amazonaws.com/dev/users",{method:"POST",body:JSON.stringify(this.state)}).then((e=>{window.location=`${window.location.origin}${window.location.pathname}#/success`})),e.preventDefault()}componentDidMount(){const{lng:e,lat:t,zoom:a}={lng:-96,lat:38.9,zoom:2.35},o=new d.a.Map({container:this.mapContainerLocation.current,style:"mapbox://styles/caseymmiler/cl11818ga000216ng2az1efhm",center:[e,t],zoom:a,cooperativeGestures:!0});o.scrollZoom.disable();const n=new d.a.ScaleControl({maxWidth:150,unit:"imperial"});o.addControl(n),n.setUnit("imperial");const s=new y.a({accessToken:"pk.eyJ1IjoiY2FzZXltbWlsZXIiLCJhIjoiY2lpeHY1bnJ1MDAyOHVkbHpucnB1dGRmbyJ9.TzUoCLwyeDoLjh3tkDSD4w",mapboxgl:d.a,countries:"us, ca, mx",marker:!1}),i=()=>{f.rangeDrawn?(o.removeLayer("circle-fill"),o.removeSource("circleData"),r()):(f.rangeDrawn=!0,r())},r=()=>{const e=parseInt(f.radius),t=h.circle(f.coordinates,e,{steps:300,units:"miles"});o.addSource("circleData",{type:"geojson",data:t}),o.addLayer({id:"circle-fill",type:"fill",source:"circleData",paint:{"fill-color":"blue","fill-opacity":.15}});const a=h.bbox(t);o.fitBounds(a,{padding:10,duration:0})},c=e=>{f.coordinates=e.result.center,f.location=e.result.place_name.replace(", United States",""),o.addSource("data-json",{type:"geojson",data:{type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:f.coordinates}}]}}),o.addLayer({id:"data-json-layer",type:"circle",source:"data-json",layout:{},paint:{"circle-radius":7,"circle-color":"#5444e3","circle-stroke-color":"#ffffff","circle-stroke-width":2}}),o.flyTo({center:f.coordinates}),i()};document.getElementById("geocoder").appendChild(s.onAdd(o)),s.on("result",(function(e){f.dotDrawn?(o.removeLayer("data-json-layer"),o.removeSource("data-json"),c(e)):(f.dotDrawn=!0,c(e))}));document.querySelector(".range").addEventListener("change",(function(e){f.radius=e.target.value,f.coordinates.length>0&&i()}))}render(){return Object(p.jsxs)("div",{className:"signup",children:[Object(p.jsx)("h1",{children:"Sign up for alerts"}),Object(p.jsx)("p",{children:"Please submit this form to sign up for text alerts of fires near your specified location."}),Object(p.jsxs)("form",{onSubmit:this.handleSubmit,children:[Object(p.jsxs)("label",{children:["Name:",Object(p.jsx)("input",{type:"text",name:"username",value:this.state.username,onChange:this.handleChange})]}),Object(p.jsxs)("label",{children:["Phone number:",Object(p.jsx)("input",{type:"text",name:"phoneNumber",value:this.state.phoneNumber,onChange:this.handleChange})]}),Object(p.jsxs)("label",{children:["Address:",Object(p.jsx)("div",{name:"location",id:"geocoder",className:"geocoder"})]}),Object(p.jsxs)("label",{children:[Object(p.jsxs)("div",{style:{position:"relative"},children:["Max distance:",Object(p.jsxs)("div",{className:"range-label",children:[this.state.radius," ","1"===this.state.radius?"mile":"miles"]})]}),Object(p.jsx)("input",{type:"range",className:"range",name:"radius",min:"1",max:"100",value:this.state.radius,onChange:this.handleChange,step:"1"})]}),Object(p.jsx)("div",{ref:this.mapContainerLocation,className:"map-container-location"}),Object(p.jsx)("input",{className:"submit",type:"submit",value:"Submit"})]})]})}}var O=e=>Object(p.jsx)(g,{});class v extends n.a.Component{render(){return Object(p.jsxs)("div",{className:"success",children:[Object(p.jsx)("h1",{children:"Success!"}),Object(p.jsx)("p",{children:"You are now signed up to receive alerts."}),Object(p.jsxs)("p",{children:["Feel free to close this page or",Object(p.jsx)(r.b,{className:"home",to:"/",children:"view the map of current fires"}),"."]})]})}}var w=()=>Object(p.jsx)(v,{});class C extends n.a.Component{render(){return Object(p.jsxs)("div",{className:"about",children:[Object(p.jsx)("h1",{children:"About this project"}),Object(p.jsxs)("p",{children:["The data for this page is provided by NIFC's Wildland Fire Interagency Geospatial Services. The ",Object(p.jsx)("a",{href:"https://data-nifc.opendata.arcgis.com/datasets/nifc::wfigs-last-24-hour-wildland-fire-locations/about",children:"WFIGS - Last 24 Hour Wildland Fire Locations data set"}),Object(p.jsx)("span",{children:"*"})," is displayed on the main map and used to generate text alerts. The image generation and text alerts are powered by ",Object(p.jsx)("a",{href:"https://github.com/caseymm/firenearby-service",children:"github actions"})," and twilio."]}),Object(p.jsxs)("p",{className:"note",children:[Object(p.jsx)("span",{children:"*"}),'This dataset does not include prescribed fires. Additionally, in an attempt to only capture fires worthy of a notice, I have filtered the data set to only include points listed as having the "DiscoveryAcres" attribute greater than or equal to 1.']}),Object(p.jsxs)("p",{children:["This project is a prototype. It does not yet (and may no ever, tbd) have a user management system. For now, if you'd like to stop receiving alerts, please email [caseymm @ gmail] or ",Object(p.jsx)("a",{href:"https://twitter.com/caseymmiller",children:"DM me"})," and I'll remove those alerts for you."]}),Object(p.jsxs)("p",{children:["I'm hoping to keep working on this and improving it, so please let me know if you find any bugs or have any ideas for improvment. Firenearby is definitely ",Object(p.jsx)("a",{href:"https://github.com/caseymm/fire-nearby",children:"still a wip"}),"."]})]})}}var S=()=>Object(p.jsx)(C,{});class L extends n.a.PureComponent{render(){return Object(p.jsx)(r.a,{children:Object(p.jsxs)(c.c,{children:[Object(p.jsx)(c.a,{exact:!0,path:"/",element:Object(p.jsx)(m,{})}),Object(p.jsx)(c.a,{exact:!0,path:"/sign-up",element:Object(p.jsx)(O,{})}),Object(p.jsx)(c.a,{exact:!0,path:"/screenshot",element:Object(p.jsx)(b,{})}),Object(p.jsx)(c.a,{exact:!0,path:"/success",element:Object(p.jsx)(w,{})}),Object(p.jsx)(c.a,{exact:!0,path:"/about",element:Object(p.jsx)(S,{})})]})})}}i.a.render(Object(p.jsx)(n.a.StrictMode,{children:Object(p.jsx)(L,{})}),document.getElementById("root"))}},[[63,1,2]]]);
//# sourceMappingURL=main.75426e4e.chunk.js.map